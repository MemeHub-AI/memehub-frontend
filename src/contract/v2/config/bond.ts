import { Hash, parseEther, zeroHash } from 'viem'
import { BigNumber } from 'bignumber.js'

import { v2BondAbi } from '../abi/bond'
import { getV2Addr } from '.'

// export const DEPLOY_FEE = BigInt(1500000000000000) // 0.0015 native token

const stepRanges = [
  7e25, 7.68e25, 8.36e25, 9.04e25, 9.72e25, 1.04e26, 1.108e26, 1.176e26,
  1.244e26, 1.312e26, 1.38e26, 1.448e26, 1.516e26, 1.584e26, 1.652e26, 1.72e26,
  1.788e26, 1.856e26, 1.924e26, 1.992e26, 2.06e26, 2.128e26, 2.196e26, 2.264e26,
  2.332e26, 2.4e26, 2.468e26, 2.536e26, 2.604e26, 2.672e26, 2.74e26, 2.808e26,
  2.876e26, 2.944e26, 3.012e26, 3.08e26, 3.148e26, 3.216e26, 3.284e26, 3.352e26,
  3.42e26, 3.488e26, 3.556e26, 3.624e26, 3.692e26, 3.76e26, 3.828e26, 3.896e26,
  3.964e26, 4.032e26, 4.1e26, 4.168e26, 4.236e26, 4.304e26, 4.372e26, 4.44e26,
  4.508e26, 4.576e26, 4.644e26, 4.712e26, 4.78e26, 4.848e26, 4.916e26, 4.984e26,
  5.052e26, 5.12e26, 5.188e26, 5.256e26, 5.324e26, 5.392e26, 5.46e26, 5.528e26,
  5.596e26, 5.664e26, 5.732e26, 5.8e26, 5.868e26, 5.936e26, 6.004e26, 6.072e26,
  6.14e26, 6.208e26, 6.276e26, 6.344e26, 6.412e26, 6.48e26, 6.548e26, 6.616e26,
  6.684e26, 6.752e26, 6.82e26, 6.888e26, 6.956e26, 7.024e26, 7.092e26, 7.16e26,
  7.228e26, 7.296e26, 7.364e26, 7.432e26, 7.5e26,
] as const

const stepPrices = [
  0, 5000000000, 5117655109, 5238078763, 5361336109, 5487493826, 5616620163,
  5748784975, 5884059760, 6022517699, 6164233695, 6309284413, 6457748323,
  6609705740, 6765238871, 6924431855, 7087370813, 7254143891, 7424841310,
  7599555413, 7778380718, 7961413965, 8148754171, 8340502684, 8536763235,
  8737641998, 8943247643, 9153691399, 9369087112, 9589551306, 9815203248,
  10046165011, 10282561540, 10524520721, 10772173449, 11025653698, 11285098597,
  11550648499, 11822447062, 12100641323, 12385381779, 12676822469, 12975121056,
  13280438914, 13592941213, 13912797010, 14240179341, 14575265313, 14918236200,
  15269277543, 15628579247, 15996335688, 16372745813, 16758013253, 17152346430,
  17555958669, 17969068317, 18391898857, 18824679032, 19267642967, 19721030296,
  20185086292, 20660062000, 21146214371, 21643806404, 22153107286, 22674392539,
  23207944166, 23754050808, 24313007898, 24885117819, 25470690071, 26070041437,
  26683496153, 27311386085, 27954050909, 28611838293, 29285104086, 29974212512,
  30679536363, 31401457205, 32140365582, 32896661228, 33670753284, 34463060517,
  35274011549, 36104045087, 36953610163, 37823166373, 38713184129, 39624144913,
  40556541535, 41510878402, 42487671791, 43487450126, 44510754267, 45558137800,
  46630167338, 47727422827, 48850497859, 49999999994,
] as const

const params = {
  mintRoyalty: 100,
  burnRoyalty: 100,
  addLiquidityTokenAmount: parseEther('250000000'),
  addLiquidityReserveAmount: parseEther('12.5'),
  reserveTotalsupply: parseEther('13.344110117830002'),
  maxSupply: parseEther('750000000'),
  stepRanges: stepRanges.map((s) => BigInt(BigNumber(s).toFixed())),
  stepPrices: stepPrices.map((s) => BigInt(s)),
} as const

export const bondDistributorParams = {
  distributionRatioKol: 0,
  distributionRatioCommunity: 0,
  walletCountKol: 0,
  walletCountCommunity: 0,
  merkleRootKol: zeroHash as Hash,
  merkleRootCommunity: zeroHash as Hash,
}

export const getBondConfig = (chainId: number | undefined) => {
  if (!chainId) return

  const addr = getV2Addr(chainId)
  if (addr.length === 0) return

  const [v2Addr, commonAddr] = addr
  const contractConfig = {
    abi: v2BondAbi,
    address: v2Addr.bond,
  } as const
  const paramsConfig = {
    ...params,
    ...commonAddr,
  } as const

  return [contractConfig, paramsConfig] as const
}
